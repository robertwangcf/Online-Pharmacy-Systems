<%-- 
    Document   : view_prescription
    Created on : 2016-4-18, 16:23:50
    Author     : Sony
--%>
<%@ page import ="java.util.*" %>

<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE html>

<html>
<head>
<title>View Prescription</title>
<style type="text/css">
.firstDiv{
width:400px;

height:300px;

margin:1cm 5cm 3cm 5cm <%--up,down,left,right--%>

}
</style>
</head>
    <body background="6809741-simple-wallpaper.jpg" background-size:100>
<%@ page import ="java.sql.*" %>
<%@ page import ="javax.sql.*" %>
<%

//String name=request.getParameter("name");
Connection con= null;
PreparedStatement ps = null;
ResultSet rs = null;

String driverName = "oracle.jdbc.driver.OracleDriver";
String url = "jdbc:oracle:" + "thin:@128.227.205.217:1521:orcl";
String user = "chaofeng";
String dbpsw = "Haohaoxuex1";

String sql = "select * from tblprescriptions where CUSTID =?";

String name = request.getParameter("paycid");
//out.println(name);
//String password = request.getParameter("password");
//String usertype = request.getParameter("usertype");
//String select_string = request.getParameter("select_string");
if(!(name.equals(null))) {
    try{
Class.forName(driverName);
con = DriverManager.getConnection(url, user, dbpsw);
ps = con.prepareStatement(sql);
ps.setString(1, name);
rs = ps.executeQuery();

if(rs.next()) {
    if(!(name.equals(rs.getString("CUSTID")))) {
    response.sendRedirect("error.jsp");
}
    %><center>
        <form class="firstDiv"  name="back Form" action="welcome2.jsp">
           <fieldset><legend> <h2 style="color:red">Prescription for customer<%= rs.getString("CUSTID") %></h2></legend><br/><br/>

<br>
<%out.println("PrescriptionID: "+ rs.getString("PRSCID") + "\n" ); %>
<br>
<%out.println("Date: "+ rs.getString("PRSCDATE") + "\n" ); %>
<br>
<%out.println("Refills: "+ rs.getString("REFILLSALLOWED")+ "\n"  ); %>
<br>
<%out.println("The doctor in response for this prescription: "+ rs.getString("DRID") + "\n" ); %>
<br>
  <input type="submit" value="Back to your personal page" >
    </form>
            </center>
    </body>
    </center>
   
<%
}
else
response.sendRedirect("error.jsp");
rs.close();
ps.close();
}
catch(SQLException sqe)
{
out.println(sqe);
} 
}

%>
<center>
   <form class="firstDiv"  name="back Form" value="confirm payment" action="confirm_payment.jsp">
       <fieldset><legend> <h2 style="color:red">Please confirm your payment</h2></legend><br/><br/>
   Prescription ID:<br>
  <input type="text" name="PrescriptionID">
  <br>
   Customer ID:<br>
  <input type="text" name="CustomerID">
  <br>
   Refill ID:<br>
    <% Random rn = new Random();
int answer = rn.nextInt(10000) + 1;
%>
  <input type="text" name="RefillID" value="<%=answer%>">
  <br>
   <h4 style ="color:red"> Tips: Refill ID is automatically generated by systems, please don't modify</h4>
  Payment amount:<br>
  <input type="text" name="amount">
  <br>
  Type:<br>
  <input type="text" name="type">
  <br>
  
  
  <input type="submit" value="confirm" >
   </form>
</center>
          
</html>
